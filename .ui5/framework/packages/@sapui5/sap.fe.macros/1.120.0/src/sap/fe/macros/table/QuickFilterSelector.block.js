/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/buildingBlocks/BuildingBlockSupport","sap/fe/core/buildingBlocks/RuntimeBuildingBlock","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/FilterHelper","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/Select","sap/ui/core/InvisibleText","sap/ui/core/Item","sap/fe/core/jsx-runtime/jsx"],function(e,t,i,r,n,o,a,l,u,c,s,f,d){"use strict";var p,h,g,b,v,m,S,y,P,C,I,B,w;var x={};var j=a.isSelectionVariant;var O=o.getTargetObjectPath;var k=o.getTargetNavigationPath;var z=o.enhanceDataModelPath;var A=n.generate;var E=r.pathInModel;var T=r.notEqual;var F=i.getInvolvedDataModelObjects;var L=e.defineBuildingBlock;var M=e.blockAttribute;function _(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function q(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;Q(e,t)}function Q(e,t){Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return Q(e,t)}function N(e,t,i,r,n){var o={};Object.keys(r).forEach(function(e){o[e]=r[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o);if(n&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(n):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function R(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let $=(p=L({name:"QuickFilterSelector",namespace:"sap.fe.macros.table"}),h=M({type:"string",required:true}),g=M({type:"sap.ui.model.Context",required:true}),b=M({type:"sap.ui.model.Context",required:true}),v=M({type:"object",required:true}),m=M({type:"function"}),p(S=(y=function(e){D(t,e);function t(t){var i;i=e.call(this,t)||this;_(i,"id",P,q(i));_(i,"metaPath",C,q(i));_(i,"contextPath",I,q(i));_(i,"filterConfiguration",B,q(i));_(i,"onSelectionChange",w,q(i));return i}x=t;var i=t.prototype;i.getSegmentedButtonSelector=function e(){const t=this.filterConfiguration.paths.map((e,t)=>d(u,{...this.getSelectorItemProperties(t)}));return d(l,{id:this.id,enabled:T(E("hasPendingFilters","pageInternal"),true),ariaLabelledBy:[this.getSelectorAriaLabelledById()],items:t,selectionChange:e=>{var t;(t=this.onSelectionChange)===null||t===void 0?void 0:t.call(this,e)}})};i.getSelectSelector=function e(){const t=this.filterConfiguration.paths.map((e,t)=>d(f,{...this.getSelectorItemProperties(t)}));return d(c,{id:this.id,enabled:T(E("hasPendingFilters","pageInternal"),true),ariaLabelledBy:[this.getSelectorAriaLabelledById()],autoAdjustWidth:true,items:t,change:e=>{var t;(t=this.onSelectionChange)===null||t===void 0?void 0:t.call(this,e)}})};i.getSelectorItemProperties=function e(t){return{key:this.filterConfiguration.paths[t].annotationPath,text:this.getSelectorItemText(t)}};i.getSelectorAriaLabelledById=function e(){return A([this.id,"AriaText"])};i.getSelectorItemText=function e(t){var i;const r=` ({internal>quickFilters/counts/${t}})`;const n=F(this.metaPath);const o=z(n,this.filterConfiguration.paths[t].annotationPath).targetObject;const a=(o===null||o===void 0?void 0:(i=o.Text)===null||i===void 0?void 0:i.toString())??"";return`${a}${this.filterConfiguration.showCounts?r:""}`};i.registerSideEffectForQuickFilter=function e(t){var i;const r=F(this.metaPath,this.contextPath);const n=(i=r.contextLocation)===null||i===void 0?void 0:i.targetEntityType.fullyQualifiedName;const o=k(r,true);const a=this.filterConfiguration.paths.map(e=>e.annotationPath);if(o&&n){const e=new Set;for(const t of a){const i=z(r,t).targetObject;if(i.SelectOptions&&j(i)){i.SelectOptions.forEach(t=>{var i;const n=(i=t.PropertyName)===null||i===void 0?void 0:i.value;if(n){const t=z(r,n);e.add(O(t,true))}})}}t.getSideEffectsService().addControlSideEffects(n,{sourceProperties:Array.from(e),targetEntities:[{$NavigationPropertyPath:o}],sourceControlId:this.id})}};i.getAccessibilityControl=function e(){const t=`{sap.fe.i18n>M_TABLE_QUICKFILTER_ARIA}`;const i=d(s,{text:t,id:this.getSelectorAriaLabelledById()});i.toStatic();return i};i.getContent=function e(t,i){if(this.filterConfiguration.showCounts){this.registerSideEffectForQuickFilter(i)}const r=this.filterConfiguration.paths.length>3?this.getSelectSelector():this.getSegmentedButtonSelector();r.addDependent(this.getAccessibilityControl());return r};return t}(t),P=N(y.prototype,"id",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),C=N(y.prototype,"metaPath",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),I=N(y.prototype,"contextPath",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),B=N(y.prototype,"filterConfiguration",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),w=N(y.prototype,"onSelectionChange",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),y))||S);x=$;return x},false);
//# sourceMappingURL=QuickFilterSelector.block.js.map