/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/ui/model/odata/v4/AnnotationHelper"],function(t,e,n,o,i,r,a){"use strict";var l={};var s=r.getDisplayMode;var u=r.getBindingWithUnitOrCurrency;var d=r.getBindingWithTimezone;var c=r.getBindingForTimezone;var v=i.hasStaticPercentUnit;var g=o.getRelativePaths;var p=o.enhanceDataModelPath;var f=n.isProperty;var m=n.isPathAnnotationExpression;var O=e.unresolvableExpression;var T=e.isPathInModelExpression;var I=e.getExpressionFromAnnotation;var b=e.formatWithTypeInformation;var _=e.formatResult;var E=e.compileExpression;var P=e.EDM_TYPE_MAPPING;const x=["Edm.Single","Edm.Double","Edm.Decimal"];const A=t=>t!==null&&t!==void 0&&t.TargetValue?I(t.TargetValue):O;const D=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros");const h=e=>{var n;const o=(e===null||e===void 0?void 0:(n=e.targetObject)===null||n===void 0?void 0:n.Value)||"";const i=g(e);let r=I(o,i);const a=A(e.targetObject);if(r&&a){var l,s,u,d;let n=e.targetObject.Value;if(!f(n)){n=e.targetObject.Value.$target}const c=((l=n.annotations)===null||l===void 0?void 0:(s=l.Measures)===null||s===void 0?void 0:s.Unit)||((u=n.annotations)===null||u===void 0?void 0:(d=u.Measures)===null||d===void 0?void 0:d.ISOCurrency);if(!c){return D.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[E(r),E(a)])}if(v(o===null||o===void 0?void 0:o.$target)){return`${E(r)} %`}r=b(n,r);const g=c.$target?b(c.$target,I(c,i)):I(c,i);return E(_([r,a,g],t.formatProgressIndicatorText))}return undefined};l.buildExpressionForProgressIndicatorDisplayValue=h;const N=t=>{var e,n,o,i,r,a;const l=g(t);const s=t===null||t===void 0?void 0:(e=t.targetObject)===null||e===void 0?void 0:(n=e.Value)===null||n===void 0?void 0:n.$target;if(!f(s)){return""}const u=((o=s.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)||((r=s.annotations)===null||r===void 0?void 0:(a=r.Measures)===null||a===void 0?void 0:a.ISOCurrency);return u?E(I(u,l)):""};l.buildUnitBindingExpression=N;const M=(t,e)=>{if(e){return V(a.value(e,{context:t}))}};const V=t=>{if(t){const e=t>1?D.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):D.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return D.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(t),e])}};const y=(t,e)=>{let n;if(e&&e.SampleSize){n=M(t,e.SampleSize)}else if(e&&e.Description){const o=a.value(e.Description,{context:t});n="${path:"+o+"}"}return n};y.requiresIContext=true;l.getHeaderRatingIndicatorText=y;const j=t=>{var e,n,o;const i=g(t);if(t!==null&&t!==void 0&&(e=t.targetObject)!==null&&e!==void 0&&(n=e.annotations)!==null&&n!==void 0&&(o=n.Common)!==null&&o!==void 0&&o.Text){var r,a;const e=I(t===null||t===void 0?void 0:(r=t.targetObject.annotations)===null||r===void 0?void 0:(a=r.Common)===null||a===void 0?void 0:a.Text,i);if(T(e)){e.parameters={$$noPatch:true}}return e}return undefined};const C=(t,e,n)=>{if(n){if(!t.formatOptions){t.formatOptions={}}t.formatOptions=Object.assign(t.formatOptions,{preserveDecimals:false,maxFractionDigits:n})}return t};const R=(t,e,n,o)=>{var i;let r;const a=(e===null||e===void 0?void 0:(i=e.path)===null||i===void 0?void 0:i.indexOf("/"))===-1?g(t):[];r=I(e,a);const l=t.targetObject;if(n&&T(r)){var s;b(l,r);r.type=(s=P[n])===null||s===void 0?void 0:s.type;if(x.includes(n)){r=C(r,e,o)}}return r};l.getValueFormatted=R;const S=(e,n,o)=>{var i,r,a,l,u,v,g;const f=e.targetObject;const m=(f===null||f===void 0?void 0:f.Value)||"";const O=m===null||m===void 0?void 0:(i=m.$target)===null||i===void 0?void 0:i.type;let T;if(x.includes(O)&&f.ValueFormat){if(f.ValueFormat.NumberOfFractionalDigits){T=f.ValueFormat.NumberOfFractionalDigits}}const I=p(e,m.path);const b=I?j(I):undefined;const P=R(I,m,O,T);const A=b?n.displayMode||s(I):"Value";let D;switch(A){case"Description":D=b;break;case"ValueDescription":D=_([P,b],t.formatWithBrackets);break;case"DescriptionValue":D=_([b,P],t.formatWithBrackets);break;default:if((r=I.targetObject)!==null&&r!==void 0&&(a=r.annotations)!==null&&a!==void 0&&(l=a.Common)!==null&&l!==void 0&&l.Timezone){D=d(I,P)}else if((u=I.targetObject)!==null&&u!==void 0&&(v=u.annotations)!==null&&v!==void 0&&(g=v.Common)!==null&&g!==void 0&&g.IsTimezone){D=c(I,P)}else{D=B(I,P,o||(n===null||n===void 0?void 0:n.measureDisplayMode)==="Hidden")}}return E(D)};l.buildFieldBindingExpression=S;const B=(t,e,n)=>{var o,i,r,a,l,s;if((o=t.targetObject)!==null&&o!==void 0&&(i=o.annotations)!==null&&i!==void 0&&(r=i.Measures)!==null&&r!==void 0&&r.Unit||(a=t.targetObject)!==null&&a!==void 0&&(l=a.annotations)!==null&&l!==void 0&&(s=l.Measures)!==null&&s!==void 0&&s.ISOCurrency){if(n&&v(t.targetObject)){return e}return u(t,e,undefined,n?{showMeasure:false}:undefined)}return e};l._computeBindingWithUnitOrCurrency=B;const L=e=>{var n,o,i,r;const a=(e===null||e===void 0?void 0:e.targetObject.Value)||"";const l=g(e);const s=I(a,l);const u=A(e.targetObject);const d=a.$target;const c=((n=d.annotations)===null||n===void 0?void 0:(o=n.Measures)===null||o===void 0?void 0:o.Unit)||((i=d.annotations)===null||i===void 0?void 0:(r=i.Measures)===null||r===void 0?void 0:r.ISOCurrency);if(c){const e=m(c)&&c.$target?b(c.$target,I(c,l)):I(c,l);return E(_([s,u,e],t.computePercentage))}return E(_([s,u,""],t.computePercentage))};l.buildExpressionForProgressIndicatorPercentValue=L;return l},false);
//# sourceMappingURL=DataPointTemplating.js.map