/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/JSTokenizer","sap/fe/core/CommonUtils","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyFormatters","sap/fe/core/type/FiscalDate","sap/fe/macros/CommonHelper","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,o,i,r,s,a){"use strict";var l={};var c=i.getProperty;var u=o.getContextRelativeTargetObjectPath;var p=n.pathInModel;var f=n.getFiscalType;var d=n.EDM_TYPE_MAPPING;var g=n.compileExpression;function m(e,n){const o=n.context.getModel();const i=n.context.getPath();const r=s.getLocationForPropertyPath(o,i);let a;let l=o.getObject(`${r}/@com.sap.vocabularies.Common.v1.ResultContext`);if(!l){var c;if(typeof e==="string"){a=e}else{a=o.getObject(`${i}@sapui.name`)}const n=t.getFilterRestrictionsByPath(r,o);l=n===null||n===void 0?void 0:(c=n.RequiredProperties)===null||c===void 0?void 0:c.includes(a)}return l}l.isRequiredInFilter=m;function v(e,n){var o;const i=n.context.getModel();const r=n.context.getPath();const a=s.getLocationForPropertyPath(i,r);let l;let c=-1;if(i.getObject(`${a}/@com.sap.vocabularies.Common.v1.ResultContext`)===true){return 1}if(typeof e==="string"){l=e}else{l=i.getObject(`${r}@sapui.name`)}const u=t.getFilterRestrictionsByPath(a,i);let p=i.getObject(`${a}/${l}`);if(!p){p=i.getObject(r)}if(p.$Type==="Edm.Boolean"){c=1}else if(u!==null&&u!==void 0&&(o=u.FilterAllowedExpressions)!==null&&o!==void 0&&o[l]){const e=t.getSpecificAllowedExpression(u.FilterAllowedExpressions[l]);if(e==="SingleValue"||e==="SingleRange"){c=1}}return c}l.maxConditions=v;function y(e){const t=u(e,false,true);return g(p(`/conditions/${t}`,"$filters"))}l.getConditionsBinding=y;function P(t,n){const o=a.format(t,n)||"";const i=o.match(/constraints:.*?({.*?})/);const r=e.parseJS((i===null||i===void 0?void 0:i[1])||"{}");if(o.includes("sap.ui.model.odata.type.DateTimeOffset")){r.V4=true}if(r.nullable===false){delete r.nullable}return Object.keys(r).length===0?undefined:JSON.stringify(r).replaceAll('"',"'")}l.constraints=P;function b(e,t){var n;if(e.$Type==="Edm.String"){if(!e.hasOwnProperty("$Nullable")||e.$Nullable===true){t.arguments=[null,{parseKeepsEmptyString:false}]}const n=f(c(e,t));if(n){if(!t.arguments){t.arguments=[null,{}]}t.arguments[1].fiscalType=n}}const o=a.format(e,t)||"";return((n=o.match(/formatOptions:.*?({.*?})/))===null||n===void 0?void 0:n[1])||undefined}l.formatOptions=b;function h(e){if(e.type==="Edm.String"){const t=f(e);if(t){return"sap.fe.core.type.FiscalDate"}}const t=d[e.type];return t?t.type:e.type}l.getDataType=h;function O(e){if(e.type==="Edm.String"){const t=f(e);if(t){return new r({fiscalType:t},{}).getPattern()}}return undefined}l.getPlaceholder=O;return l},false);
//# sourceMappingURL=FilterFieldHelper.js.map