/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/UIFormatters"],function(e,n,t,o,i,a,r,l){"use strict";var c={};var s=l.getActionEnabledExpression;var u=r.replaceSpecialChars;var d=a.resolveBindingString;var f=a.pathInModel;var v=a.or;var p=a.isConstant;var b=a.ifElse;var m=a.greaterOrEqual;var y=a.formatResult;var g=a.constant;var h=a.compileExpression;var A=a.and;var S=o.getCustomActionID;var E=t.Placement;var k=n.ActionType;let C;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(C||(C={}));c.ButtonType=C;function I(e,n,t,o){const i=n.find(e=>e.key===o);const a=e[o];const r={...i??a};if(i){r.enabled=(a===null||a===void 0?void 0:a.enabled)??i.enabled;r.visible=(a===null||a===void 0?void 0:a.visible)??i.visible;for(const e in a||{}){const n=e;if(!i[n]&&n!=="menu"){r[n]=a[n]}}}const l=((r===null||r===void 0?void 0:r.visible)||(r===null||r===void 0?void 0:r.type)===k.DataFieldForAction||(r===null||r===void 0?void 0:r.type)===k.DataFieldForIntentBasedNavigation)&&!t.find(e=>e.key===(r===null||r===void 0?void 0:r.key));return{action:r,canBeMenuItem:l}}function M(e,n,t,o,i){const{action:a,canBeMenuItem:r}=I(n,t,i,e.defaultAction);if(r){e.defaultAction=a}if(a.command){o[a.key]=a}}function F(e,n,t,o,i){const a=[];for(const r of e.menu??[]){const{action:e,canBeMenuItem:l}=I(n,t,i,r);if(l){a.push(e)}if(e.command){o[r]=e}}e.menu=a;const r=a.map(e=>d(e.visible,"boolean"));e.visible=h(A(d(e.visible,"boolean"),v(...r)))}function x(e,n,t){const o={};const i=[];const a={};for(const l in e){const c=e[l];if(c.defaultAction!==undefined){M(c,e,n,a,t)}if(c.type===k.Menu){var r;i.push(...c.menu);F(c,e,n,a,t);if(!((r=c.menu)!==null&&r!==void 0&&r.length)){i.push(c.key)}}if(c.command){a[l]=c}o[l]=c}i.forEach(e=>delete o[e]);return{actions:o,commandActions:a}}const O=function(e,n,t){if(n&&e.enabled===undefined){return undefined}const o=N(e.enabled,t);return h(b(e.requiresSelection===true,A(m(f("numberOfSelectedContexts","internal"),1),o),o))};const P=function(e,n,t){if(n&&e.visible===undefined){return undefined}const o=N(e.visible,t);return h(o)};function D(e,n){if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=e.enabled??n.enabled;e.visible=e.visible??n.visible}function T(e,n){if(n!==null&&n!==void 0&&n.find(n=>n.key===e.key)){e.visible="false"}}function B(e,n,t,o,i,a,r){const l={};for(const d in e){var c,s;const f=e[d];const v=((c=f.press)===null||c===void 0?void 0:c.lastIndexOf("."))||-1;const p=t===null||t===void 0?void 0:t.find(e=>e.key===d);const b=!!p;if(f.facetName){r=f.facetName}l[d]={id:p?d:S(d),type:f.menu?k.Menu:k.Default,visible:P(f,b,n),enabled:O(f,b,n),handlerModule:f.press&&f.press.substring(0,v).replace(/\./gi,"/"),handlerMethod:f.press&&f.press.substring(v+1),press:f.press,text:f.text,noWrap:f.__noWrap,key:u(d),enableOnSelect:f.enableOnSelect,defaultValuesExtensionFunction:f.defaultValuesFunction,position:{anchor:(s=f.position)===null||s===void 0?void 0:s.anchor,placement:f.position===undefined?E.After:f.position.placement},isNavigable:L(f,o,i),command:f.command,requiresSelection:f.requiresSelection===undefined?false:f.requiresSelection,enableAutoScroll:R(f),menu:f.menu??[],facetName:f.inline?r:undefined,defaultAction:f.defaultAction};D(l[d],p);T(l[d],a)}return x(l,t??[],a??[])}c.getActionsFromManifest=B;function N(e,n){const t=d(e,"boolean");let o;if(p(t)&&t.value===undefined){o=g(true)}else if(p(t)&&typeof t.value==="string"){var a;const e=t.value;o=y([f("/","$view"),e,f("selectedContexts","internal")],i.customBooleanPropertyCheck,((a=n.getDataModelObjectPath().contextLocation)===null||a===void 0?void 0:a.targetEntityType)||n.getEntityType())}else{o=t}return o}const j=e=>{let n={};e.forEach(e=>{var t;if(e!==null&&e!==void 0&&(t=e.menu)!==null&&t!==void 0&&t.length){const t=e.menu;n=t.reduce((e,n)=>{let{key:t}=n;if(t&&!e[t]){e[t]=true}return e},n)}});return e.filter(e=>!n[e.key])};c.removeDuplicateActions=j;function U(e,n){var t;let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(n!==null&&n!==void 0&&(t=n.annotations.Core)!==null&&t!==void 0&&t.OperationAvailable){const t=e.getDataModelObjectPath();const i=s(n,e.getConvertedTypes(),t,o);return h(i)}return"true"}c.getEnabledForAnnotationAction=U;function q(e){return e?e.map(e=>({LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty})):[]}c.getSemanticObjectMapping=q;function L(e,n,t){var o,i;let a=true;if(t){const e=n&&(n.detail||n.display);a=e!==null&&e!==void 0&&e.route?true:false}if(e&&e.afterExecution&&(((o=e.afterExecution)===null||o===void 0?void 0:o.navigateToInstance)===false||((i=e.afterExecution)===null||i===void 0?void 0:i.enableAutoScroll)===true)||!a){return false}return true}c.isActionNavigable=L;function R(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}c.enableAutoScroll=R;function $(e){var n,t,o;return((n=e.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(o=t.IsCopyAction)===null||o===void 0?void 0:o.valueOf())===true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}c.dataFieldIsCopyAction=$;function w(n){if(n.length===1){return n[0]}if(n.length>1){e.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.")}return undefined}c.getCopyAction=w;return c},false);
//# sourceMappingURL=Action.js.map