/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/MassEditHelper","sap/fe/core/helpers/ModelHelper","sap/m/MessageBox","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","../CommonUtils"],function(e,t,o,n,i,r,a,s){"use strict";var l,c,p,g,d,E,u,_,f;var M=t.publicExtension;var T=t.privateExtension;var C=t.finalExtension;var S=t.extensible;var A=t.defineUI5Class;function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;y(e,t)}function y(e,t){y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return y(e,t)}function O(e,t,o,n,i){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}let x=(l=A("sap.fe.core.controllerextensions.MassEdit"),c=M(),p=C(),g=M(),d=C(),E=T(),u=S(a.After),l(_=(f=function(t){D(r,t);function r(){return t.apply(this,arguments)||this}var a=r.prototype;a.getMessageDetailForNonEditable=function e(t,o,n){const i=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_HEADER"),r=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON",[n]),a=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_DRAFT",[o]),s=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_NON_EDITABLE",[o]);return`<p><strong>${i}</strong></p>\n`+(!!r&&`<p>${r}</p>\n`+`<ul>`+(!!a&&`<li>${a}</li>`)+(!!s&&`<li>${s}</li>`)+`</ul>`)};a.getResourceText=function e(t,o){const n=t&&s.getTranslatedTextFromExpBindingString(t,o);return n&&n.toLocaleLowerCase()};a._openConfirmDialog=async function t(o,r,a){const s=(r||[]).length;const l=this.getView();return new Promise(t=>{l.getModel("sap.fe.i18n").getResourceBundle().then(c=>{const p=c.getText("C_MASS_EDIT_CONFIRM_BUTTON_TEXT"),g=c.getText("C_COMMON_OBJECT_PAGE_CANCEL"),d=a-s,E=o.data("entityType"),u=o.getModel().getMetaModel(),_=u.getObject(`${E}@com.sap.vocabularies.UI.v1.HeaderInfo`),f=_&&this.getResourceText(_.TypeName,l)||c.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME"),M=_&&this.getResourceText(_.TypeNamePlural,l)||c.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME_PLURAL"),T=c.getText("C_MASS_EDIT_CONFIRM_MESSAGE",[d,a,s,M]),C=o.data("targetCollectionPath"),S=o.getModel().getMetaModel(),A=n.isDraftSupported(S,C),D=o.data("displayModePropertyBinding")==="true",y=A&&D&&this.getMessageDetailForNonEditable(c,f,M);i.warning(T,{details:y,actions:[p,g],emphasizedAction:p,contentWidth:"100px",onClose:function(o){let n=[];if(o===p){e.info("Mass Edit: Confirmed to edit ",s.toString()," selections.");n=r}else if(o===g){e.info("Mass Edit: Cancelled.")}t(n)}})}).catch(function(t){e.error(t)})})};a.openMassEditDialog=async function t(n){try{const e=this.getView().getController(),t=await this.fetchContextsForEdit(n)??[],i=n.getBindingContext("internal").getProperty("numberOfSelectedContexts")||0,r=t.length&&t.length!==i?await this._openConfirmDialog(n,t,i):t,a=r!==null&&r!==void 0&&r.length?await o.createDialog(n,r,e):undefined;if(a){n.addDependent(a);a.open()}}catch(t){e.error("Mass Edit: Something went wrong in mass edit dialog creation.",t)}};a.fetchContextsForEdit=function e(t){const o=t.getBindingContext("internal"),n=o.getProperty("updatableContexts")||[];return Promise.resolve(n)};return r}(r),O(f.prototype,"getMessageDetailForNonEditable",[c,p],Object.getOwnPropertyDescriptor(f.prototype,"getMessageDetailForNonEditable"),f.prototype),O(f.prototype,"openMassEditDialog",[g,d],Object.getOwnPropertyDescriptor(f.prototype,"openMassEditDialog"),f.prototype),O(f.prototype,"fetchContextsForEdit",[E,u],Object.getOwnPropertyDescriptor(f.prototype,"fetchContextsForEdit"),f.prototype),f))||_);return x},false);
//# sourceMappingURL=MassEdit.js.map