/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/suite/ui/commons/collaboration/ServiceContainer","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(t,i,e){"use strict";var n={};function o(t,i){t.prototype=Object.create(i.prototype);t.prototype.constructor=t;a(t,i)}function a(t,i){a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(i,e){i.__proto__=e;return i};return a(t,i)}let r=function(i){o(e,i);function e(){return i.apply(this,arguments)||this}n.CollaborativeToolsService=e;var a=e.prototype;a.init=function t(){this.teamsIntegration={isInitialized:false};this.initPromise=Promise.resolve(this)};a.getInterface=function t(){return this};a.initializeMSTeams=async function i(){const e=await t.getServiceAsync();this.teamsIntegration.isInitialized=true;this.teamsIntegration.helperService=e;this.teamsIntegration.isContactsCollaborationSupported=typeof e.isContactsCollaborationSupported==="function"&&e.isContactsCollaborationSupported()};a.getMailPopoverFromMsTeamsIntegration=async function t(i){if(!this.teamsIntegration.isInitialized){await this.initializeMSTeams()}try{var e;return await((e=this.teamsIntegration.helperService)===null||e===void 0?void 0:e.enableMinimalContactsCollaboration(i))}catch{return undefined}};a.isContactsCollaborationSupported=async function t(){if(!this.teamsIntegration.isInitialized){await this.initializeMSTeams()}return this.teamsIntegration.isContactsCollaborationSupported===true};a.getTeamContactOptions=async function t(){if(!this.teamsIntegration.isInitialized){await this.initializeMSTeams()}if(!this.teamsIntegration.isContactsCollaborationSupported){return undefined}if(!this.teamsIntegration.contactOptions){try{var i;this.teamsIntegration.contactOptions=await((i=this.teamsIntegration.helperService)===null||i===void 0?void 0:i.getTeamsContactCollabOptions())}catch{return undefined}}return this.teamsIntegration.contactOptions};return e}(i);n.CollaborativeToolsService=r;let s=function(t){o(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;e.createInstance=async function t(i){const e=new r(i);return e.initPromise};return i}(e);return s},false);
//# sourceMappingURL=CollaborativeToolsServiceFactory.js.map