/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/suite/ui/commons/collaboration/CollaborationHelper","sap/ui/VersionInfo","sap/ui/core/Core","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","../converters/MetaModelConverter"],function(e,t,i,n,r,a){"use strict";var s={};var o=a.DefaultEnvironmentCapabilities;function c(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;l(e,t)}function l(e,t){l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return l(e,t)}let p=function(e){c(n,e);function n(){return e.apply(this,arguments)||this}s.EnvironmentCapabilitiesService=n;var r=n.prototype;r.init=function e(){this.initPromise=new Promise((e,t)=>{this.resolveFn=e;this.rejectFn=t});const i=this.getContext();this.environmentCapabilities=Object.assign({},o);t.load().then(async e=>{this.environmentCapabilities.Chart=!!e.libraries.find(e=>e.name==="sap.viz");this.environmentCapabilities.MicroChart=!!e.libraries.find(e=>e.name==="sap.suite.ui.microchart");this.environmentCapabilities.UShell=!!(sap&&sap.ushell&&sap.ushell.Container);this.environmentCapabilities.IntentBasedNavigation=!!(sap&&sap.ushell&&sap.ushell.Container);this.environmentCapabilities.InsightsSupported=!!e.libraries.find(e=>e.name==="sap.insights")&&await h();this.environmentCapabilities=Object.assign(this.environmentCapabilities,i.settings);this.resolveFn(this);return null}).catch(this.rejectFn)};n.resolveLibrary=async function e(t){return new Promise(function(e){try{i.loadLibrary(`${t.replace(/\./g,"/")}`,{async:true}).then(function(){e(true)}).catch(function(){e(false)})}catch(t){e(false)}})};r.setCapabilities=function e(t){this.environmentCapabilities=t};r.setCapability=function e(t,i){this.environmentCapabilities[t]=i};r.getCapabilities=function e(){return this.environmentCapabilities};r.getInterface=function e(){return this};return n}(n);s.EnvironmentCapabilitiesService=p;let u=function(e){c(t,e);function t(){return e.apply(this,arguments)||this}s.EnvironmentServiceFactory=t;var i=t.prototype;i.createInstance=function e(t){const i=new p(t);return i.initPromise};return t}(r);s.EnvironmentServiceFactory=u;async function h(){return new Promise(async e=>{try{const t=await p.resolveLibrary("sap.insights");if(t){sap.ui.require(["sap/insights/CardHelper"],async t=>{try{await t.getServiceAsync("UIService");e(!await v())}catch{e(false)}})}else{e(false)}}catch{e(false)}})}s.getInsightsEnabled=h;async function v(){let t=false;try{t=await e.isTeamsModeActive()}catch{return false}return t}s.getMSTeamsActive=v;return s},false);
//# sourceMappingURL=EnvironmentServiceFactory.js.map