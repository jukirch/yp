/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","../../../helpers/StableIdHelper","../../helpers/DataFieldHelper","../Common/Form"],function(e,t,a,i,o,n,r,l,s,c){"use strict";var d={};var v=c.getFormElementsFromManifest;var u=c.FormElementType;var p=s.isReferencePropertyStaticallyHidden;var f=s.isAnnotationFieldStaticallyHidden;var m=l.createIdForAnnotation;var g=r.isVisible;var b=n.isMultiLineText;var y=o.compileExpression;var F=i.KeyHelper;var I=a.getHeaderFacetID;var h=a.getHeaderFacetFormID;var T=a.getHeaderFacetContainerID;var $=a.getCustomHeaderFacetID;var D=t.insertCustomElements;var U=t.Placement;var C=e.getSemanticObjectPath;let A;(function(e){e["Annotation"]="Annotation";e["XMLFragment"]="XMLFragment"})(A||(A={}));d.HeaderFacetType=A;let P;(function(e){e["Reference"]="Reference";e["Collection"]="Collection"})(P||(P={}));d.FacetType=P;let S;(function(e){e["Default"]="Default";e["NotAdaptable"]="not-adaptable";e["NotAdaptableTree"]="not-adaptable-tree";e["NotAdaptableVisibility"]="not-adaptable-visibility"})(S||(S={}));d.FlexDesignTimeType=S;var H;(function(e){e["ProgressIndicator"]="ProgressIndicator";e["RatingIndicator"]="RatingIndicator";e["Content"]="Content"})(H||(H={}));var N;(function(e){e["None"]="None";e["DataPoint"]="DataPoint";e["Chart"]="Chart";e["Identification"]="Identification";e["Contact"]="Contact";e["Address"]="Address";e["FieldGroup"]="FieldGroup"})(N||(N={}));function R(e){var t,a,i;const o=[];(t=e.getEntityType().annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.HeaderFacets)===null||i===void 0?void 0:i.forEach(t=>{const a=G(t,e);if(a){o.push(a)}});return o}d.getHeaderFacetsFromAnnotations=R;function E(e){const t={};Object.keys(e).forEach(a=>{const i=e[a];t[a]=w(i,a)});return t}d.getHeaderFacetsFromManifest=E;function k(e,t,a){var i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return false}const o=m(e)??"";const n=a.getManifestWrapper().getHeaderFacets();const r=(i=n[o])===null||i===void 0?void 0:i.stashed;return r===true}d.getStashedSettingsForHeaderFacet=k;function V(e,t,a){let i=S.Default;const o=m(e);if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){i=S.NotAdaptableTree}else{const e=a.getManifestWrapper().getHeaderFacets();if(o){var n,r;const t=(n=e[o])===null||n===void 0?void 0:(r=n.flexSettings)===null||r===void 0?void 0:r.designtime;switch(t){case S.NotAdaptable:case S.NotAdaptableTree:case S.NotAdaptableVisibility:i=t;break;default:break}}}return i}d.getDesignTimeMetadataSettingsForHeaderFacet=V;function L(e,t,a){var i,o,n;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!(((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:(n=o.Hidden)===null||n===void 0?void 0:n.valueOf())===true)){var r,l;const i=I(e),o=(e,t)=>{var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t},n=e.Target.value,s=M(e);let c;let d;switch(s){case N.FieldGroup:c=O(e,a);break;case N.DataPoint:d=B(e,a);break;default:break}if(((r=e.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:l.term)==="com.sap.vocabularies.UI.v1.Chart"&&f(e)){return undefined}else{return{type:A.Annotation,facetType:P.Reference,id:i,containerId:T(e),key:o(e,i),flexSettings:{designtime:V(e,t,a)},stashed:k(e,t,a),visible:y(g(e)),annotationPath:`${a.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,targetAnnotationValue:n,targetAnnotationType:s,headerFormData:c,headerDataPointData:d}}}return undefined}function x(e,t){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){const a=[],i=I(e),o=(e,t)=>{var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t};e.Facets.forEach(i=>{const o=L(i,e,t);if(o){a.push(o)}});return{type:A.Annotation,facetType:P.Collection,id:i,containerId:T(e),key:o(e,i),flexSettings:{designtime:V(e,e,t)},stashed:k(e,e,t),visible:y(g(e)),annotationPath:`${t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,facets:a}}return undefined}function M(e){let t=N.None;const a={"com.sap.vocabularies.UI.v1.DataPoint":N.DataPoint,"com.sap.vocabularies.UI.v1.Chart":N.Chart,"com.sap.vocabularies.UI.v1.Identification":N.Identification,"com.sap.vocabularies.Communication.v1.Contact":N.Contact,"com.sap.vocabularies.Communication.v1.Address":N.Address,"com.sap.vocabularies.UI.v1.FieldGroup":N.FieldGroup};if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"&&e.Target.$target){t=a[e.Target.$target.term]??N.None}return t}function O(e,t){var a;if(!e){throw new Error("Cannot get FieldGroup form data without facet definition")}const i=D(j(e,t),v(e,t));return{id:h(e),label:(a=e.Label)===null||a===void 0?void 0:a.toString(),formElements:i}}function j(e,t){const a=[];if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,o;(i=e.Target)===null||i===void 0?void 0:(o=i.$target)===null||o===void 0?void 0:o.Data.forEach(i=>{var o,n,r;if(!(((o=i.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:(r=n.Hidden)===null||r===void 0?void 0:r.valueOf())===true)){const o=C(t,i);if((i.$Type==="com.sap.vocabularies.UI.v1.DataField"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")&&!p(i)){var l,s,c,d,v;a.push({isValueMultilineText:b((l=i.Value)===null||l===void 0?void 0:l.$target),type:u.Annotation,key:F.generateKeyFromDataField(i),visible:y(g(i)),label:((s=i.Value)===null||s===void 0?void 0:(c=s.$target)===null||c===void 0?void 0:(d=c.annotations)===null||d===void 0?void 0:(v=d.Common)===null||v===void 0?void 0:v.Label)||i.Label,idPrefix:h(e,i),annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`,semanticObjectPath:o})}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&!p(i)){var f,m,I,T,$,D;a.push({isValueMultilineText:false,type:u.Annotation,key:F.generateKeyFromDataField(i),visible:y(g(i)),label:((f=i.Target)===null||f===void 0?void 0:(m=f.$target)===null||m===void 0?void 0:(I=m.annotations)===null||I===void 0?void 0:(T=I.Common)===null||T===void 0?void 0:($=T.Label)===null||$===void 0?void 0:$.toString())||((D=i.Label)===null||D===void 0?void 0:D.toString()),idPrefix:h(e,i),annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`,semanticObjectPath:o})}}})}return a}function B(e,t){let a=H.Content;let i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!f(e)){var o,n,r,l,s;if(((o=e.Target)===null||o===void 0?void 0:(n=o.$target)===null||n===void 0?void 0:n.Visualization)==="UI.VisualizationType/Progress"){a=H.ProgressIndicator}else if(((r=e.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:l.Visualization)==="UI.VisualizationType/Rating"){a=H.RatingIndicator}const u=(s=e.Target)===null||s===void 0?void 0:s.$target;if(typeof u==="object"){var c;if(u!==null&&u!==void 0&&(c=u.Value)!==null&&c!==void 0&&c.$target){var d,v;const e=u.Value.$target;if((e===null||e===void 0?void 0:(d=e.annotations)===null||d===void 0?void 0:(v=d.Common)===null||v===void 0?void 0:v.SemanticObject)!==undefined){i=t.getEntitySetBasedAnnotationPath(e===null||e===void 0?void 0:e.fullyQualifiedName)}}}}return{type:a,semanticObjectPath:i}}function G(e,t){let a;switch(e.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":a=L(e,e,t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":a=x(e,t);break;default:break}return a}function W(e){if(!e){return undefined}const t=["Heroes","Decoration","Workers","LongRunners"].includes(e)?`$auto.${e}`:e;return`{ path : '', parameters : { $$groupId : '${t}' } }`}function w(e,t){const a=$(t);let i=e.position;if(!i){i={placement:U.After}}return{facetType:P.Reference,type:e.type,id:a,containerId:a,key:t,position:i,visible:e.visible,fragmentName:e.template||e.name,title:e.title,subTitle:e.subTitle,stashed:e.stashed||false,flexSettings:{...{designtime:S.Default},...e.flexSettings},binding:W(e.requestGroupId),templateEdit:e.templateEdit}}return d},false);
//# sourceMappingURL=HeaderFacet.js.map