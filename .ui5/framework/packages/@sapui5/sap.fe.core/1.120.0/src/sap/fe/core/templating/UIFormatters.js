/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper","sap/ui/mdc/enums/FieldEditMode"],function(e,t,n,i,o,a,l,r,s,d){"use strict";var u={};var c=s.isMultiLineText;var v=s.isKey;var f=s.isImmutable;var p=s.isComputed;var g=s.hasValueHelp;var m=s.hasStaticPercentUnit;var y=s.getAssociatedUnitProperty;var h=s.getAssociatedCurrencyProperty;var b=r.isRequiredExpression;var T=r.isReadOnlyExpression;var E=r.isNonEditableExpression;var x=r.isDisabledExpression;var D=a.isPathUpdatable;var I=a.getTargetObjectPath;var $=a.getRelativePaths;var M=a.getContextRelativeTargetObjectPath;var O=a.enhanceDataModelPath;var P=o.isProperty;var C=o.isPathAnnotationExpression;var V=o.isMultipleNavigationProperty;var U=i.unresolvableExpression;var F=i.pathInModel;var j=i.or;var w=i.notEqual;var A=i.not;var S=i.isTruthy;var q=i.isConstant;var B=i.ifElse;var N=i.getExpressionFromAnnotation;var R=i.formatWithTypeInformation;var W=i.formatResult;var z=i.equal;var L=i.constant;var k=i.compileExpression;var H=i.and;var K=i.addTypeInformation;var G=i.EDM_TYPE_MAPPING;var _=n.singletonPathVisitor;var Q=n.bindingContextPathVisitor;var Y=n.UI;var J=e.getInvolvedDataModelObjects;var X=e.convertMetaModelContext;const Z=function(e){return l.getDisplayMode(e.targetObject,e)};u.getDisplayMode=Z;const ee=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:Y.IsEditable;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;return te(e,t,n,true,i,o)};u.getEditableExpressionAsObject=ee;const te=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:Y.IsEditable;let a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;if(!e||typeof e==="string"){return k(false)}let l=L(true);if(t!==null){l=B(E(t),false,o)}const r=C(e)?e.$target:e;const s=$(n);const d=D(n,{propertyPath:e,pathVisitor:(e,t)=>_(e,n.convertedTypes,t)});if(k(d)==="false"&&a){return i?d:"false"}const u=r!==undefined?B(j(H(A(d),a),p(r),v(r),f(r),E(r,s)),B(j(p(r),E(r,s)),false,Y.IsTransientBinding),o):U;if(i){return H(u,l)}return k(H(u,l))};u.getEditableExpression=te;const ne=function(e,t){var n;const i=I(e);const o=F(`/collaboration/activities${i}`,"internal");const a=e===null||e===void 0?void 0:(n=e.targetEntityType)===null||n===void 0?void 0:n.keys;const l=[];a===null||a===void 0?void 0:a.forEach(function(e){const t=F(e.name);l.push(t)});return W([o,...l],t)};u.getCollaborationExpression=ne;const ie=function(e,t,n){return oe(e,t,true,n)};u.getEnabledExpressionAsObject=ie;const oe=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return k(true)}let o;if(i){o=$(i)}let a=L(true);if(t!==null){a=B(x(t),false,true)}const l=C(e)?e.$target:e;const r=l!==undefined?B(x(l,o),false,true):U;if(n){return H(r,a)}return k(H(r,a))};u.getEnabledExpression=oe;const ae=function(e,t){var n,i,o,a;let l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let u=arguments.length>5&&arguments[5]!==undefined?arguments[5]:Y.IsEditable;if(!e||typeof e==="string"||(s===null||s===void 0?void 0:s.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return d.Display}const c=C(e)?e.$target:e;const v=$(t);const g=D(t,{propertyPath:c,pathVisitor:(e,n)=>_(e,t.convertedTypes,n)});const m=ee(e,s,t,u,false);const b=ie(e,s,t);const E=h(c);const x=E||y(c);let I=L(d.Editable);if(x){const e=T(x,v);I=B(j(e,p(x),H(f(x),A(Y.IsTransientBinding)),l),B(!q(e)&&e,d.EditableReadOnly,d.EditableDisplay),d.Editable)}if(!x&&(c!==null&&c!==void 0&&(n=c.annotations)!==null&&n!==void 0&&(i=n.Measures)!==null&&i!==void 0&&i.ISOCurrency||c!==null&&c!==void 0&&(o=c.annotations)!==null&&o!==void 0&&(a=o.Measures)!==null&&a!==void 0&&a.Unit)){I=L(d.EditableDisplay)}const M=j(T(c,v),T(s));const O=B(j(g,Y.IsTransientBinding),B(b,B(m,I,B(H(!q(M)&&M,u),d.ReadOnly,d.Display)),B(u,d.Disabled,d.Display)),d.Display);if(r){return O}return k(O)};u.getEditMode=ae;const le=function(e){var t,n,i,o;const a=e.targetObject;const l=(t=a.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.ISOCurrency;const r=l?l:(i=a.annotations)===null||i===void 0?void 0:(o=i.Measures)===null||o===void 0?void 0:o.Unit;if(r){return k(j(S(N(r)),A(Y.IsTotal)))}else{return k(L(true))}};u.hasValidAnalyticalCurrencyOrUnit=le;const re=function(e,t,n){var i,o;const a=C(e)&&e.$target||e;const l=((i=a.annotations)===null||i===void 0?void 0:(o=i.Common)===null||o===void 0?void 0:o.Text)!==undefined;return g(a)?k(t):l?k(B(z(n,"Editable"),"Value",t)):"Value"};u.getFieldDisplay=re;const se=function(e,t){var n,i,o,a;const l=G[e===null||e===void 0?void 0:e.type]||(t?G[t]:undefined);const r={type:l.type,constraints:{},formatOptions:{}};if(P(e)){var s,d,u,c,v,f,p,g,m,y,h,b,T,E,x,D,I,$;r.constraints={scale:(s=l.constraints)!==null&&s!==void 0&&s.$Scale?e.scale:undefined,precision:(d=l.constraints)!==null&&d!==void 0&&d.$Precision?e.precision:undefined,maxLength:(u=l.constraints)!==null&&u!==void 0&&u.$MaxLength?e.maxLength:undefined,nullable:(c=l.constraints)!==null&&c!==void 0&&c.$Nullable?e.nullable:undefined,minimum:(v=l.constraints)!==null&&v!==void 0&&v["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((f=e.annotations)===null||f===void 0?void 0:(p=f.Validation)===null||p===void 0?void 0:p.Minimum)?`${(g=e.annotations)===null||g===void 0?void 0:(m=g.Validation)===null||m===void 0?void 0:m.Minimum}`:undefined,maximum:(y=l.constraints)!==null&&y!==void 0&&y["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((h=e.annotations)===null||h===void 0?void 0:(b=h.Validation)===null||b===void 0?void 0:b.Maximum)?`${(T=e.annotations)===null||T===void 0?void 0:(E=T.Validation)===null||E===void 0?void 0:E.Maximum}`:undefined,isDigitSequence:r.type==="sap.ui.model.odata.type.String"&&(x=l.constraints)!==null&&x!==void 0&&x["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&(D=e.annotations)!==null&&D!==void 0&&(I=D.Common)!==null&&I!==void 0&&I.IsDigitSequence?true:undefined,V4:($=l.constraints)!==null&&$!==void 0&&$.$V4?true:undefined}}r.formatOptions={parseAsString:(r===null||r===void 0?void 0:(n=r.type)===null||n===void 0?void 0:n.indexOf("sap.ui.model.odata.type.Int"))===0||(r===null||r===void 0?void 0:(i=r.type)===null||i===void 0?void 0:i.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(r===null||r===void 0?void 0:(o=r.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Int"))===0||(r===null||r===void 0?void 0:(a=r.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:r.type==="sap.ui.model.odata.type.String"?true:undefined};return r};u.getTypeConfig=se;const de=function(e,n,i,o){var a,l,r,s;const d=e.targetObject;let u=(a=d.annotations)===null||a===void 0?void 0:(l=a.Measures)===null||l===void 0?void 0:l.Unit;const c=$(e);n=R(d,n);if(m(d)){if((o===null||o===void 0?void 0:o.showMeasure)===false){return n}return W([n],t.formatWithPercentage)}const v=u?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";u=u?u:(r=d.annotations)===null||r===void 0?void 0:(s=r.Measures)===null||s===void 0?void 0:s.ISOCurrency;const f=C(u)&&u.$target?R(u.$target,N(u,c),i):N(u,c);return K([n,f],v,undefined,o)};u.getBindingWithUnitOrCurrency=de;const ue=function(e){var t,n,i,o;const a=e.targetObject;let l=(t=a.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.Unit;if(m(a)){return L("%")}const r=$(e);const s=l?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";l=l?l:(i=a.annotations)===null||i===void 0?void 0:(o=i.Measures)===null||o===void 0?void 0:o.ISOCurrency;const d=C(l)&&l.$target?R(l.$target,N(l,r)):N(l,r);let u=F(M(e));u=R(a,u,true);return K([u,d],s,undefined,{parseKeepsEmptyString:true,showNumber:false})};u.getBindingForUnitOrCurrency=ue;const ce=function(e,t){var n,i;let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let l=arguments.length>4?arguments[4]:undefined;const r=e.targetObject;const s=(n=r.annotations)===null||n===void 0?void 0:(i=n.Common)===null||i===void 0?void 0:i.Timezone;const d=$(e);t=R(r,t);const u="sap.fe.core.type.DateTimeWithTimezone";const c=s.$target?R(s.$target,N(s,d),o):N(s,d);let v={};if(a){v={showTimezoneForEmptyValues:false}}if(l!==null&&l!==void 0&&l.showTime){v={...v,...{showTime:l.showTime==="false"?false:true}}}if(l!==null&&l!==void 0&&l.showDate){v={...v,...{showDate:l.showDate==="false"?false:true}}}if(l!==null&&l!==void 0&&l.showTimezone){v={...v,...{showTimezone:l.showTimezone==="false"?false:true}}}return K([t,c],u,undefined,v)};u.getBindingWithTimezone=ce;const ve=function(e,t){const n=e.targetObject;t=R(n,t);t.type="any";const i="sap.ui.model.odata.type.DateTimeWithTimezone";const o={showTime:false,showDate:false,showTimezone:true};return K([null,t],i,undefined,o)};u.getBindingForTimezone=ve;const fe=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return k(B(z(e,"Display"),t,n))};u.getAlignmentExpression=fe;const pe=function(e,t){if(t&&t.context){return X(t.context)}return null};pe.requiresIContext=true;u.getConverterContext=pe;const ge=function(e,t){if(t&&t.context){return J(t.context)}return null};ge.requiresIContext=true;u.getDataModelObjectPath=ge;const me=function(e){var t;if((t=e.navigationProperties)!==null&&t!==void 0&&t.length){const t=(e===null||e===void 0?void 0:e.navigationProperties.findIndex(t=>{if(V(t)){var n,i;if((n=e.contextLocation)!==null&&n!==void 0&&(i=n.navigationProperties)!==null&&i!==void 0&&i.length){var o;return((o=e.contextLocation)===null||o===void 0?void 0:o.navigationProperties.findIndex(e=>e.name===t.name))===-1}return true}return false}))>-1;if(t){return true}}return false};u.isMultiValueField=me;const ye=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return he(e,t,n,true)};u.getRequiredExpressionAsObject=ye;const he=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};let a=arguments.length>5?arguments[5]:undefined;const l=o.requiredPropertiesFromInsertRestrictions;const r=o.requiredPropertiesFromUpdateRestrictions;if(!e||typeof e==="string"){if(i){return L(false)}return k(L(false))}let s;if(a){s=$(a)}let d=L(false);if(t!==null&&t!==undefined){d=b(t)}let u=L(false);let c=L(false);const v=C(e)&&e.$target||e;const f=b(v,s);const p=n||Y.IsEditable;if(l!==null&&l!==void 0&&l.includes(e.name)){u=Y.IsCreateMode}if(r!==null&&r!==void 0&&r.includes(e.name)){c=H(Y.IsEditable,A(Y.IsCreateMode))}const g=j(H(j(f,d),p),u,c);if(i){return g}return k(g)};u.getRequiredExpression=he;const be=function(e){var t,n;const i=e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.Data;const o=Object.keys(i);const a=[];let l;const r=[];for(const e of o){if(i[e]["$Type"]&&i[e]["$Type"].indexOf("DataField")>-1){a.push(i[e])}}for(const e of a){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof e.Value==="object"){l=e.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.Target.$target){if(e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){if(typeof e.Target.$target.Value==="object"){l=e.Target.$target.Value.$target}}else{if(typeof e.Target==="object"){l=e.Target.$target}break}}break}r.push(ye(l,e,false))}return k(j(...r))};u.getRequiredExpressionForConnectedDataField=be;function Te(e){var t,n;return A(z(N(e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Hidden),true))}u.isVisible=Te;const Ee=function(e){return c(e.targetObject)};u.isMultiLine=Ee;function xe(e,t,n,i){var o,a,l;let r="";if(n&&i&&i===true&&(o=n.contextLocation)!==null&&o!==void 0&&o.targetEntityType&&n.contextLocation.targetEntityType!==e.sourceEntityType){const t=$(n);let i=O(n.contextLocation);for(const n of t){i=O(i,n);if(i.targetEntityType===e.sourceEntityType){r=`${$(i).join("/")}/`;break}}}const s=e.isBound?(a=e.parameters[0])===null||a===void 0?void 0:a.fullyQualifiedName:undefined;const d=N((l=e.annotations.Core)===null||l===void 0?void 0:l.OperationAvailable,[],undefined,e=>`${r}${Q(e,t,s)}`);return w(d,false)}u.getActionEnabledExpression=xe;return u},false);
//# sourceMappingURL=UIFormatters.js.map