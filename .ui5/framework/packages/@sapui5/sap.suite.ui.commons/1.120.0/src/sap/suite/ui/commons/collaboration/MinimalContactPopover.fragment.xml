<core:FragmentDefinition
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
    xmlns:fesr="http://schemas.sap.com/sapui5/extension/sap.ui.core.FESR/1"
    xmlns:macrodata="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
	<Popover
        id="ContactPopover"
        class="sapUiContentPadding"
        placement="Auto"
        initialFocus="action"
        showHeader="false"
        contentWidth="25rem"
        afterClose="afterClose">
        <VBox>
            <HBox>
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="chat"
                    icon="sap-icon://discussion"
                    type="Transparent"
                    class="sapUiSmallMarginEnd"
                    fesr:press="MST:ContactDetails"
                />
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="videoCall"
                    icon="sap-icon://video"
                    type="Transparent"
                    class="sapUiSmallMarginEnd"
                    fesr:press="MST:ContactDetails"
                />
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="call"
                    icon="sap-icon://call"
                    type="Transparent"
                    fesr:press="MST:ContactDetails"
                />
            </HBox>

            <HBox class="sapUiTinyMarginTop">
                <core:Icon
                    src="sap-icon://email">
                </core:Icon>
                <Link text="{userData>/mail}" href="{path: 'userData>/mail', formatter: '.formatUri'}" class="sapUiSmallMarginBegin sapUiTinyMarginBottom" />
            </HBox>
        </VBox>
	</Popover>
</core:FragmentDefinition>